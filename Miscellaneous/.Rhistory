### Plot bootstrap distribution of TE association
#############################################################################
# The raw data I collected from the output of the Snakemake pipelines TreeCertainty.smk and Phylogeny.smk
# =======================================
# Sandra Lorena Ament Velasquez
# Johannesson Lab, Evolutionary Biology Center, Uppsala University, Sweden
# 2020-01-13
# Version 1
# =======================================
library(dplyr, warn.conflicts = FALSE)
library(ggplot2, quietly = TRUE)
# P. anserina
observed_an <- read.table("/Users/lore/Dropbox/PhD_UU/Analyses/JohannessonsServer/3_SpokBlockPaper/4_BootstrapTEs/distributions/PaWa137m-TEs-1000bp_obsvalues.txt", header = TRUE)
randvalues_an <- read.table("/Users/lore/Dropbox/PhD_UU/Analyses/JohannessonsServer/3_SpokBlockPaper/4_BootstrapTEs/distributions/PaWa137m-TEs-1000bp_randvalues_10000.txt", header = TRUE)
# P. pauciseta
observed_pa <- read.table("/Users/lore/Dropbox/PhD_UU/Analyses/JohannessonsServer/3_SpokBlockPaper/4_BootstrapTEs/distributions/CBS237.71m-TEs-1000bp_obsvalues.txt", header = TRUE)
randvalues_pa <- read.table("/Users/lore/Dropbox/PhD_UU/Analyses/JohannessonsServer/3_SpokBlockPaper/4_BootstrapTEs/distributions/CBS237.71m-TEs-1000bp_randvalues_10000.txt", header = TRUE)
# P. comata
observed_co <- read.table("/Users/lore/Dropbox/PhD_UU/Analyses/JohannessonsServer/3_SpokBlockPaper/4_BootstrapTEs/distributions/PcWa139m-TEs-1000bp_obsvalues.txt", header = TRUE)
randvalues_co <- read.table("/Users/lore/Dropbox/PhD_UU/Analyses/JohannessonsServer/3_SpokBlockPaper/4_BootstrapTEs/distributions/PcWa139m-TEs-1000bp_randvalues_10000.txt", header = TRUE)
observed_an %>% head
mean_an <- observed_an$Coverage %>% mean()
mean_pa <- observed_pa$Coverage %>% mean()
mean_co <- observed_co$Coverage %>% mean()
mean_an
mean_pa
mean_co
randvalues_an %>% head
cbind(Species = "P_anserina", randvalues_an)
cbind(Strain = "PcWa139m", randvalues_co),
randvalues <- rbind(cbind(Strain = "PaWa137m", randvalues_an),
cbind(Strain = "CBS237.71m", randvalues_pa),
cbind(Strain = "PcWa139m", randvalues_co))
randvalues %>% head
randvalues %>% tail
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(xintercept = observed$Coverage %>% mean(), colour = "red") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ Coverage)
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(xintercept = observed$Coverage %>% mean(), colour = "red") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .)
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
# geom_vline(xintercept = observed$Coverage %>% mean(), colour = "red") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .)
dummyframe <- data.frame(Strain = c("PaWa137m", "CBS237.71m", "PcWa139m"), mean = c(mean_an, mean_pa, mean_co))
dummyframe
?geom_vline
meansframe <- data.frame(Strain = c("PaWa137m", "CBS237.71m", "PcWa139m"), mean = c(mean_an, mean_pa, mean_co))
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(xintercept = mean, colour = "red", data = meansframe) +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .)
meansframe <- data.frame(Strain = c("PaWa137m", "CBS237.71m", "PcWa139m"), Mean = c(mean_an, mean_pa, mean_co))
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe) +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .)
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe) +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
geom_density(alpha=0.6)+
theme(legend.position="none") # Remove legend
range(randvalues_an$Coverage)
range(randvalues_an$Coverage)
quantile(randvalues_an$Coverage)
quantile(randvalues_an$Coverage, probs = c(0.05, 0.95))
quantile(randvalues_an$Coverage, probs = c(0.05, 0.95)) %>% str()
quantile(randvalues_an$Coverage, probs = c(0.05, 0.95))[1]
quantile(randvalues_an$Coverage, probs = c(0.05, 0.95))[2]
quantile(randvalues_an$Coverage, probs = c(0.05, 0.95))[[2]]
source('~/Dropbox/Programming/GitHubRepos/Genomics/Miscellaneous/gff2bootstrap_plot.R')
quantile95 <- data.frame(Strain = c("PaWa137m", "CBS237.71m", "PcWa139m"),
Mean = c(quantile(randvalues_an$Coverage, probs = c(0.05, 0.95))[[2]],
quantile(randvalues_pa$Coverage, probs = c(0.05, 0.95))[[2]],
quantile(randvalues_co$Coverage, probs = c(0.05, 0.95))[[2]]))
quantile95 <- data.frame(Strain = c("PaWa137m", "CBS237.71m", "PcWa139m"),
quantile95 = c(quantile(randvalues_an$Coverage, probs = c(0.05, 0.95))[[2]],
quantile(randvalues_pa$Coverage, probs = c(0.05, 0.95))[[2]],
quantile(randvalues_co$Coverage, probs = c(0.05, 0.95))[[2]]))
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
geom_vline(aes(xintercept = quantile95, colour = "blue"), data = quantile95) +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
# geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
geom_vline(aes(xintercept = quantile95, colour = "blue"), data = quantile95) +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
# geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
geom_vline(aes(xintercept = quantile95, colour = "pink"), data = quantile95) +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
# geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
geom_vline(aes(xintercept = quantile95), data = quantile95, colour = "pink") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
# geom_vline(aes(xintercept = Mean, colour = "red"), data = meansframe, linetype="dashed") +
geom_vline(aes(xintercept = quantile95), data = quantile95, colour = "darkred") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean), data = meansframe, colour = "red", linetype="dashed") +
geom_vline(aes(xintercept = quantile95), data = quantile95, colour = "darkred") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) +
theme(legend.position="none") # Remove legend
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean), data = meansframe, colour = "red", linetype="dashed") +
geom_vline(aes(xintercept = quantile95), data = quantile95, colour = "darkred") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .) #+
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean), data = meansframe, colour = "red", linetype="dashed") +
geom_vline(aes(xintercept = quantile95), data = quantile95, colour = "darkred") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .)
quantile(randvalues_an$Coverage, probs = c(0.05, 0.95)
)
quantile(randvalues_an$Coverage, probs = c(0.95))
quantile(randvalues_an$Coverage, probs = 0.95)
quantile95 <- data.frame(Strain = c("PaWa137m", "CBS237.71m", "PcWa139m"),
quantile95 = c(quantile(randvalues_an$Coverage, probs = 0.95)[[1]],
quantile(randvalues_pa$Coverage, probs = 0.95)[[1]],
quantile(randvalues_co$Coverage, probs = 0.95)[[1]]))
# Plot
ggplot(randvalues, aes(x = Coverage)) + geom_histogram() +
geom_vline(aes(xintercept = Mean), data = meansframe, colour = "red", linetype="dashed") +
geom_vline(aes(xintercept = quantile95), data = quantile95, colour = "darkred") +
theme_bw() + ylab("Frequency") + facet_grid(Strain ~ .)
